<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Cestas BÃ¡sicas</title>
<style>
:root{--pri:#007bff;--ok:#28a745;--bg:#f5f5f5;--rad:8px;--sh:0 3px 10px rgba(0,0,0,.12)}
*{box-sizing:border-box;margin:0;padding:0;font-family:Arial,Helvetica,sans-serif}
body{background:var(--bg)}
header{background:var(--pri);color:#fff;padding:18px;display:flex;justify-content:space-between;align-items:center}
header a{color:#fff;text-decoration:none;font-size:1.2rem;margin-left:20px;position:relative}
.badge{position:absolute;top:-6px;right:-10px;background:var(--ok);padding:0 6px;border-radius:9999px;font-size:.75rem}
.grid{max-width:1200px;margin:30px auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:22px;padding:0 18px}
.card{background:#fff;border-radius:var(--rad);box-shadow:var(--sh);overflow:hidden;cursor:pointer;transition:.25s}
.card:hover{transform:translateY(-4px)}
.card img{width:100%}
.card h3{padding:10px;font-size:1rem}
.modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:300}
.modal.show{display:flex}
.box{background:#fff;padding:26px;border-radius:var(--rad);box-shadow:var(--sh);max-width:500px;width:92%;max-height:90vh;overflow:auto;position:relative}
.close{position:absolute;top:10px;right:14px;font-size:1.5rem;border:none;background:none;cursor:pointer}
ul{padding-left:20px;margin-top:8px}
.controls{margin:14px 0;display:flex;align-items:center;gap:8px}
.controls input{width:44px;text-align:center}
.btn{display:block;width:100%;padding:12px;border:none;border-radius:var(--rad);font-weight:600;cursor:pointer;margin-top:14px}
.btn-buy{background:var(--ok);color:#fff}
.btn-main{background:var(--pri);color:#fff}
#cart{position:fixed;top:0;right:-420px;width:380px;height:100%;background:#fff;box-shadow:-4px 0 14px rgba(0,0,0,.15);transition:right .35s;display:flex;flex-direction:column;z-index:200}
#cart.open{right:0}
.cart-h,.cart-f{padding:18px;border-bottom:1px solid #eee;display:flex;justify-content:space-between;align-items:center}
.cart-items{flex:1;overflow-y:auto;padding:18px;display:flex;flex-direction:column;gap:14px}
.cart-f{border-top:1px solid #eee;border-bottom:none;flex-direction:column;gap:16px}
.cart-f .total{display:flex;justify-content:space-between;width:100%;font-weight:700}
input[type=radio]{margin-right:6px}
fieldset{border:1px solid #ddd;margin:14px 0;padding:10px;border-radius:var(--rad)}
fieldset legend{padding:0 6px}
fieldset.hidden{display:none}
</style>
</head>
<body>
<header>
  <h1>Cestas BÃ¡sicas</h1>
  <div>
    <a id="loginLink" href="#">ðŸ‘¤</a>
    <a id="cartLink" href="#">ðŸ›’<span id="badge" class="badge">0</span></a>
  </div>
</header>

<section id="grid" class="grid"></section>

<!-- modal detalhe / checkout -->
<div id="modal" class="modal"><div id="modalBox" class="box"></div></div>

<!-- carrinho -->
<aside id="cart">
  <div class="cart-h"><h2>Carrinho</h2><button class="close" onclick="toggleCart()">Ã—</button></div>
  <div id="cartItems" class="cart-items"></div>
  <div class="cart-f">
    <div class="total"><span>Total</span><span id="cartTotal">R$ 0,00</span></div>
    <button class="btn btn-main" onclick="checkout()">Finalizar compra</button>
  </div>
</aside>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script>
/* ------- dados -------- */
const FRETE = 19.90;
const cestas = [
 {id:1,nome:"Cesta Casado",preco:89.99},
 {id:2,nome:"Cesta Solteiro",preco:79.99},
 {id:3,nome:"Cesta Dia a Dia",preco:69.99},
 {id:4,nome:"Cesta EconÃ´mica",preco:59.99},
 {id:5,nome:"Cesta DoaÃ§Ã£o",preco:49.99},
 {id:6,nome:"Kit Generosidade",preco:39.99}
];
/* ------- helpers ------- */
const $=s=>document.querySelector(s),fmt=v=>'R$ '+v.toFixed(2).replace('.',',');
/* ------- estado ------- */
let cart=[];
/* ------- grid ------- */
cestas.forEach(c=>{grid.insertAdjacentHTML('beforeend',
 `<div class="card" onclick="addCart(${c.id})"><img src="cesta-exemplo.jpg"><h3>${c.nome} â€“ ${fmt(c.preco)}</h3></div>`);});
/* ------- carrinho ------- */
function addCart(id){
 const obj=cart.find(i=>i.id===id); obj?obj.q++:cart.push({id,q:1});
 badge.textContent=cart.reduce((s,i)=>s+i.q,0);
 renderCart(); toggleCart();
}
function toggleCart(){$('#cart').classList.toggle('open');renderCart();}
function renderCart(){
 cartItems.innerHTML='';
 if(!cart.length){cartItems.innerHTML='<p>Carrinho vazio.</p>';cartTotal.textContent='R$ 0,00';return;}
 cart.forEach(i=>{
   const c=cestas.find(x=>x.id===i.id);
   cartItems.insertAdjacentHTML('beforeend',`<div style="display:flex;justify-content:space-between"><span>${i.q}Ã— ${c.nome}</span><span>${fmt(i.q*c.preco)}</span></div>`);
 });
 const total=cart.reduce((s,i)=>s+i.q*cestas.find(x=>x.id===i.id).preco,0)+FRETE;
 cartTotal.textContent=fmt(total);
}
/* ------- checkout ------- */
function checkout(){
 if(!cart.length){alert('Carrinho vazio');return;}
 const total=parseFloat(cartTotal.textContent.replace('R$','').replace(',','.'));
 modalBox.innerHTML=`
  <button class="close" onclick="closeM()">Ã—</button>
  <h2>Pagamento</h2>
  <p>Total a pagar: <strong>${fmt(total)}</strong> (frete ${fmt(FRETE)} incluso)</p>
  <label><input type="radio" name="pg" value="pix" checked onchange="togglePay()"> Pix</label>
  <label><input type="radio" name="pg" value="card" onchange="togglePay()"> CartÃ£o</label>

  <fieldset id="pixBox"><legend>QR-Code Pix</legend><div id="qr"></div></fieldset>

  <fieldset id="cardBox" class="hidden"><legend>Dados do cartÃ£o</legend>
     <input id="cc-num" placeholder="NÃºmero do cartÃ£o"><br>
     <input id="cc-name" placeholder="Nome do titular"><br>
     <input id="cc-exp" placeholder="MM/AA"><br>
     <input id="cc-cvv" placeholder="CVV (3 ou 4)"><br>
  </fieldset>

  <button class="btn btn-main" onclick="finalizar(${total})">Finalizar compra</button>`;
 new QRCode($('#qr'),{text:'PIX '+fmt(total),width:180,height:180});
 modal.classList.add('show');
}
function togglePay(){
 const pg=[...document.querySelectorAll('input[name=pg]')].find(r=>r.checked).value;
 $('#pixBox').classList.toggle('hidden',pg!=='pix');
 $('#cardBox').classList.toggle('hidden',pg!=='card');
}
function finalizar(total){
 const pg=[...document.querySelectorAll('input[name=pg]')].find(r=>r.checked).value;
 if(pg==='card' && !validaCartao()) return;
 cart=[];badge.textContent='0';renderCart();closeM();alert('Pedido confirmado! Valor '+fmt(total));
}
function validaCartao(){
 const n=$('#cc-num').value, nm=$('#cc-name').value, ex=$('#cc-exp').value, cv=$('#cc-cvv').value;
 if(!(luhn(n)&&/^[A-Za-zÃ€-Ã¿' ]{2,26}$/.test(nm.trim())&&/^\d{2}\/\d{2}$/.test(ex)&&/^\d{3,4}$/.test(cv))){
   alert('Dados de cartÃ£o invÃ¡lidos');return false;} return true;}
/* ------- utils ------- */
function luhn(v){v=v.replace(/\D/g,'');let s=0,a=false;for(let i=v.length-1;i>=0;i--){let n=parseInt(v[i]);if(a){n*=2;if(n>9)n-=9;}s+=n;a=!a;}return s%10==0;}
function closeM(){modal.classList.remove('show');}
modal.onclick=e=>{if(e.target.id==='modal')closeM();}
cartLink.onclick=e=>{e.preventDefault();toggleCart();}
</script>
</body>
</html>
